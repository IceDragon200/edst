#!/usr/bin/env ruby
# edst-parse2yaml
# Converts .edst files to token json data
require 'yaml'
require 'json'
require 'rake/ext/string'
require 'edst/parser'

ARGV.each do |filename|
  content = File.read filename
  result = EDST::Parser.new.tokenize(content, verbose: false).map(&:to_h)
  File.write(filename.ext("yml"), JSON.load(JSON.dump(result)).to_yaml)
end
